<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù†ØªØ§Ø¦Ø¬ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ùˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
body {
    font-family: Tahoma, Arial, sans-serif;
    background: #f0f0f0;
    margin: 0; padding: 0;
}
.container {
    max-width: 400px;
    margin: 0 auto;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 0 10px #ccc;
    padding: 20px;
    margin-top: 20px;
}
h2, h3 { margin: 10px 0; }
input, button {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 1em;
}
button {
    background: #007bff;
    color: white;
    border: none;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.2s;
}
button:hover { background: #0056b3; }
label { display: block; margin-top: 10px; }
.team-title {
    background: #eee;
    padding: 8px;
    border-radius: 6px;
    margin-bottom: 10px;
    text-align: center;
    font-weight: bold;
}
.score-box {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 8px 0;
}
.score-box input {
    width: 60px;
    margin: 0 5px;
    text-align: center;
}
.score-box.team1 input {
    background: #e3f0ff;
    border: 2px solid #007bff;
}
.score-box.team2 input {
    background: #ffe3e3;
    border: 2px solid #ff3b3b;
}
.scores-total {
    background: #f8f9fa;
    padding: 8px;
    border-radius: 6px;
    text-align: center;
    font-weight: bold;
    margin-top: 10px;
}
.winner-banner {
    background: #28a745;
    color: white;
    padding: 10px;
    text-align: center;
    font-size: 20px;
    margin-bottom: 10px;
    border-radius: 8px;
}
.smile {
    font-size: 1.5em;
    color: #ff9800;
    margin-left: 5px;
}
.sticker {
    color: #ff3b3b;
    font-weight: bold;
    margin-right: 5px;
}
@media (max-width: 500px) {
    .container { padding: 10px; }
    input, button { font-size: 0.95em; }
}
</style>
</head>
<body>
<div class="container" id="welcome">
    <h2>Ø£Ù‡Ù„Ø§ ÙˆØ³Ù‡Ù„Ø§ Ø¨ÙŠÙƒ ÙÙŠ Ù†ØªØ§Ø¦Ø¬ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ùˆ ÙŠØ§ Ø­Ø¶Ø±Øª Ø§Ù„Ù„Ø§Ø¹Ø¨</h2>
    <p>ØªØ­ÙŠØ© Ø®Ø§ØµØ© Ù„Ø£Ù…ÙŠÙ† Ø§Ù„Ø­Ø¯ÙŠØ«ÙŠ Ø§Ù„ÙŠ Ø³ÙˆØ§ Ù‡Ø§ÙŠ Ø§Ù„ØµÙØ­Ø© ğŸŒŸ<br>ÙˆØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ÙˆÙŠÙ„Ø§ Ù†Ø¨Ù„Ø´!</p>
    <button onclick="showTeam1()">Ø§Ø¨Ø¯Ø£ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
</div>

<div class="container" id="team1" style="display:none;">
    <div class="team-title">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</div>
    <input type="text" id="team1name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„">
    <input type="text" id="t1p1" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„">
    <input type="text" id="t1p2" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ">
    <button onclick="showTeam2()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>

<div class="container" id="team2" style="display:none;">
    <div class="team-title">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
    <input type="text" id="team2name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ">
    <input type="text" id="t2p1" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„">
    <input type="text" id="t2p2" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ">
    <button onclick="startGame()">Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨</button>
</div>

<div class="container" id="game" style="display:none;">
    <div id="gameInfo"></div>
    <div class="team-title" id="team1title"></div>
    <div class="score-box team1">
        <span id="t1p1name"></span>
        <input type="number" id="t1p1score" placeholder="Ø§Ù„Ù†Ù‚Ø§Ø·">
    </div>
    <div class="score-box team1">
        <span id="t1p2name"></span>
        <input type="number" id="t1p2score" placeholder="Ø§Ù„Ù†Ù‚Ø§Ø·">
    </div>
    <div class="scores-total">Ù…Ø¬Ù…ÙˆØ¹ Ù†Ù‚Ø§Ø· Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„: <span id="team1total">0</span></div>
    <hr>
    <div class="team-title" id="team2title"></div>
    <div class="score-box team2">
        <span id="t2p1name"></span>
        <input type="number" id="t2p1score" placeholder="Ø§Ù„Ù†Ù‚Ø§Ø·">
    </div>
    <div class="score-box team2">
        <span id="t2p2name"></span>
        <input type="number" id="t2p2score" placeholder="Ø§Ù„Ù†Ù‚Ø§Ø·">
    </div>
    <div class="scores-total">Ù…Ø¬Ù…ÙˆØ¹ Ù†Ù‚Ø§Ø· Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ: <span id="team2total">0</span></div>
    <button onclick="addScores()">Ø¥Ø¯Ø®Ø§Ù„</button>
</div>

<div class="container" id="result" style="display:none;"></div>

<script>
let team1 = {name:"", players:["",""], scores:[0,0]};
let team2 = {name:"", players:["",""], scores:[0,0]};
let gameStarted = false, startTime = "", endTime = "";

function showTeam1() {
    document.getElementById("welcome").style.display = "none";
    document.getElementById("team1").style.display = "block";
}
function showTeam2() {
    team1.name = document.getElementById("team1name").value || "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„";
    team1.players[0] = document.getElementById("t1p1").value || "Ù„Ø§Ø¹Ø¨ 1";
    team1.players[1] = document.getElementById("t1p2").value || "Ù„Ø§Ø¹Ø¨ 2";
    document.getElementById("team1").style.display = "none";
    document.getElementById("team2").style.display = "block";
}
function startGame() {
    team2.name = document.getElementById("team2name").value || "Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ";
    team2.players[0] = document.getElementById("t2p1").value || "Ù„Ø§Ø¹Ø¨ 1";
    team2.players[1] = document.getElementById("t2p2").value || "Ù„Ø§Ø¹Ø¨ 2";
    document.getElementById("team2").style.display = "none";
    document.getElementById("game").style.display = "block";
    startTime = new Date();
    document.getElementById("gameInfo").innerHTML = `<p>ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${startTime.toLocaleString("ar-EG")}</p>`;
    document.getElementById("team1title").innerText = team1.name;
    document.getElementById("team2title").innerText = team2.name;
    document.getElementById("t1p1name").innerText = team1.players[0];
    document.getElementById("t1p2name").innerText = team1.players[1];
    document.getElementById("t2p1name").innerText = team2.players[0];
    document.getElementById("t2p2name").innerText = team2.players[1];
    gameStarted = true;
}
function addScores() {
    if (!gameStarted) return;
    let s1 = Number(document.getElementById("t1p1score").value) || 0;
    let s2 = Number(document.getElementById("t1p2score").value) || 0;
    let s3 = Number(document.getElementById("t2p1score").value) || 0;
    let s4 = Number(document.getElementById("t2p2score").value) || 0;
    team1.scores[0] += s1;
    team1.scores[1] += s2;
    team2.scores[0] += s3;
    team2.scores[1] += s4;
    document.getElementById("t1p1score").value = "";
    document.getElementById("t1p2score").value = "";
    document.getElementById("t2p1score").value = "";
    document.getElementById("t2p2score").value = "";
    document.getElementById("team1total").innerText = team1.scores[0] + team1.scores[1];
    document.getElementById("team2total").innerText = team2.scores[0] + team2.scores[1];
    checkWinner();
}
function checkWinner() {
    let total1 = team1.scores[0] + team1.scores[1];
    let total2 = team2.scores[0] + team2.scores[1];
    if ((total1 >= 151 || total2 >= 151)) {
        document.getElementById("game").style.display = "none";
        endTime = new Date();
        showResults(total1, total2);
    }
}
function showResults(total1, total2) {
    let winner, loser, winnerPlayers, loserPlayers, winnerScores, loserScores, winnerTotal, loserTotal;
    if (total1 > total2) {
        winner = team1.name;
        loser = team2.name;
        winnerPlayers = team1.players;
        loserPlayers = team2.players;
        winnerScores = team1.scores;
        loserScores = team2.scores;
        winnerTotal = total1;
        loserTotal = total2;
    } else {
        winner = team2.name;
        loser = team1.name;
        winnerPlayers = team2.players;
        loserPlayers = team1.players;
        winnerScores = team2.scores;
        loserScores = team1.scores;
        winnerTotal = total2;
        loserTotal = total1;
    }
    let bestIndex = winnerScores.indexOf(Math.max(...winnerScores));
    let bestPlayer = winnerPlayers[bestIndex];
    let durationMs = endTime - startTime;
    let durationMin = Math.floor(durationMs / 60000);
    let durationSec = Math.floor((durationMs % 60000) / 1000);

    // Ø¥Ø°Ø§ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø®Ø§Ø³Ø± Ù†ØªÙŠØ¬ØªÙ‡ ØµÙØ± Ø£Ø¶Ù Ø³Ù…Ø§ÙŠÙ„Ø§Øª Ùˆ"Ù…Ù„Øµ"
    let loserTable = "";
    if (loserTotal === 0) {
        loserTable = `
        <h3>${loser} <span class="smile">ğŸ˜„</span></h3>
        <table>
            <tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th><th></th></tr>
            <tr>
                <td>${loserPlayers[0]}</td>
                <td>0</td>
                <td><span class="smile">ğŸ˜„</span> <span class="sticker">Ù…Ù„Øµ</span></td>
            </tr>
            <tr>
                <td>${loserPlayers[1]}</td>
                <td>0</td>
                <td><span class="smile">ğŸ˜„</span> <span class="sticker">Ù…Ù„Øµ</span></td>
            </tr>
            <tr><th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th><th colspan="2">0</th></tr>
        </table>
        `;
    } else {
        loserTable = `
        <h3>${loser}</h3>
        <table>
            <tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th></tr>
            <tr>
                <td>${loserPlayers[0]}</td>
                <td>${loserScores[0]}</td>
            </tr>
            <tr>
                <td>${loserPlayers[1]}</td>
                <td>${loserScores[1]}</td>
            </tr>
            <tr><th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th><th>${loserTotal}</th></tr>
        </table>
        `;
    }

    let html = `
    <div class="winner-banner">ğŸ† ${winner} Ù‡Ùˆ Ø§Ù„ÙØ§Ø¦Ø² ğŸ†</div>
    <h3>${winner}</h3>
    <table>
        <tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th></tr>
        <tr>
            <td>${winnerPlayers[0]}</td>
            <td>${winnerScores[0]}</td>
        </tr>
        <tr>
            <td>${winnerPlayers[1]}</td>
            <td>${winnerScores[1]}</td>
        </tr>
        <tr><th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th><th>${winnerTotal}</th></tr>
    </table>
    ${loserTable}
    <h3>ğŸŒŸ Ø£ÙØ¶Ù„ Ù„Ø§Ø¹Ø¨: ${bestPlayer}</h3>
    <p>ğŸ“… ÙˆÙ‚Øª Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©: ${startTime.toLocaleString("ar-EG")}</p>
    <p>ğŸ“… ÙˆÙ‚Øª Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©: ${endTime.toLocaleString("ar-EG")}</p>
    <p>â±ï¸ Ù…Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©: ${durationMin} Ø¯Ù‚ÙŠÙ‚Ø© Ùˆ ${durationSec} Ø«Ø§Ù†ÙŠØ©</p>
    <button onclick="downloadImage('${winner}', '${endTime.toLocaleDateString("ar-EG")}', '${endTime.toLocaleTimeString("ar-EG")}')">ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
    `;
    document.getElementById("result").innerHTML = html;
    document.getElementById("result").style.display = "block";
}
function downloadImage(winner, dateStr, timeStr){
    // ØµÙŠØ§ØºØ© Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù: Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„ÙØ§Ø¦Ø²-ØªØ§Ø±ÙŠØ®-Ø³Ø§Ø¹Ø©.png
    dateStr = dateStr.replace(/\//g, "-");
    timeStr = timeStr.replace(/:/g, "-");
    let fileName = `${winner}-${dateStr}-${timeStr}.png`;
    html2canvas(document.getElementById("result")).then(canvas=>{
        let link = document.createElement("a");
        link.download = fileName;
        link.href = canvas.toDataURL();
        link.click();
    });
}
</script>
</body>
</html>